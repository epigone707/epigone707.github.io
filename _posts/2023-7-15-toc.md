---
layout: post
title: "Automated Table of Contents for Jekyll with Highlighting"
description: "A tutorial about how to create a table of contents for your Jekyll website. The table of contents will be automatically generated based on the headings in your markdown file. It will also highlight the current section you are reading."
category: tech
tags: web
modify: 2023-7-15 18:09:00
---

# Intro

This is a tutorial on how to add a table of contents to your Jekyll website. The table of contents will be automatically generated based on the headings in your markdown file. It will also highlight the current section you are reading.

What we want is: (1) customizable, (2) automatically highlight the current section, (3) as a sidebar.

# Final Result

This is what the table of contents looks like after you complete this tutorial.

![toc result](/assets/images/toc.png)

# Libraries Used

- [jekyll-table-of-contents](https://github.com/ghiculescu/jekyll-table-of-contents)
- Bootstrap's [scrollspy](https://getbootstrap.com/docs/4.0/components/scrollspy/#methods)

# Tutorial

## Step 1

Download [jekyll-table-of-contents](https://github.com/ghiculescu/jekyll-table-of-contents) as `toc.js` in your `js` folder.

## Step 2

Add the following to your `head.html` file

```html
<!-- jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

<!-- bootstrap -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!-- toc -->
<script src="/js/toc.js"></script>
```

## Step 3

Add `<div id="toc"></div>` and corresponding js function to your html file.

For my website, I added it to `default.html` like this:

```html
<div id="toc-wrapper">
  <div id="toc"></div>
</div>

<script type="text/javascript">
  $(document).ready(function () {
    $("#toc").toc({ listType: "ul" });
  });
</script>
```

## Step 4

Set up Bootstrap's [scrollspy](https://getbootstrap.com/docs/4.0/components/scrollspy/#methods) by modifing your body tag like this:

```html
<body data-spy="scroll" data-target="#toc" data-offset="75"></body>
```

## Step 5

Add css code for the table of contents sidebar to make it sticks on the right side of the page and appears properly.

This depends on the layout of your website. For my website, I added the following:

- [\_layout.scss](https://github.com/epigone707/epigone707.github.io/blob/master/_sass/_layout.scss)
- [\_toc.scss](https://github.com/epigone707/epigone707.github.io/blob/master/_sass/_toc.scss)

# Existed Issues

If your post contains non-english header, the automated highlighting won't work preperly. I am still working on this issue.

For example, if you have this Chinese header in your post markdown:

```
## 21 法师的故事
```

It will be converted to:

```html
<h2 id="21-法师的故事" class="clickable-header">21 法师的故事</h2>
```

And the corresponding link in the table of contents generated by [jekyll-table-of-contents](https://github.com/ghiculescu/jekyll-table-of-contents) will be:

```
<a class="" href="#21-%E6%B3%95%E5%B8%88%E7%9A%84%E6%95%85%E4%BA%8B">21 法师的故事</a>
```

As you can see, the non-english characters are converted to url encoded format. This will cause the Bootstrap's [scrollspy](https://getbootstrap.com/docs/4.0/components/scrollspy/#methods) highlighting to fail.

Related links:

- [bootstrap issue 1](https://github.com/twbs/bootstrap/issues/10205)
- [bootstrap issue 2](https://github.com/twbs/bootstrap/issues/37545)
- [bootstrap issue 3](https://github.com/twbs/bootstrap/issues/38367)
